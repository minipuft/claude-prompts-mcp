import type { GateEnforcementMode } from '../../gates/types.js';
import type { InjectionState } from '../pipeline/decisions/injection/index.js';
/**
 * Typed internal state for the execution pipeline.
 */
export interface PipelineInternalState {
    /**
     * State related to modular injection control.
     * Controls when system prompts, gate guidance, and style guidance are injected.
     * @see injection/types.ts for InjectionState definition
     */
    injection: InjectionState;
    /**
     * State related to the Two-Phase Judge Selection and Framework Resolution.
     */
    framework: {
        /** Explicit framework override selected by the client (Judge Phase) */
        clientOverride?: string;
        /** Gate IDs selected by the client (Judge Phase) */
        clientSelectedGates?: string[];
        /** Style ID selected by the client (Judge Phase) */
        clientSelectedStyle?: string;
        /** Whether the judge selection phase was triggered */
        judgePhaseTriggered: boolean;
        /** Whether style guidance has been applied */
        styleEnhancementApplied: boolean;
        /** Coordination flag to prevent duplicate system prompt injection */
        systemPromptApplied?: boolean;
        /** The specific style guidance text applied */
        selectedStyleGuidance?: string;
    };
    /**
     * State related to Request Normalization and Command Canonicalization.
     */
    normalization: {
        /** Whether the normalization stage has completed successfully */
        completed: boolean;
        /** Whether this is a canonical pipeline execution */
        isCanonical: boolean;
        /** The final normalized command string */
        normalizedCommand?: string;
        /** Request-level options passed through */
        requestOptions?: Record<string, unknown>;
    };
    /**
     * State related to Session Lifecycle and Continuity.
     */
    session: {
        /** ID of the session being resumed */
        resumeSessionId?: string;
        /** ID of the chain being resumed */
        resumeChainId?: string;
        /** Whether a previous execution blueprint was restored */
        isBlueprintRestored: boolean;
        /** Whether this is an explicit chain resume operation */
        isExplicitChainResume: boolean;
        /** The decision made by the lifecycle manager (e.g., 'create-new', 'resume') */
        lifecycleDecision?: string;
        /** ID of the current execution scope */
        executionScopeId?: string;
        /** Whether the session/chain has been aborted by user choice */
        aborted?: boolean;
        /** Whether the chain has already advanced past the final step */
        chainComplete?: boolean;
    };
    /**
     * State related to Gates and Validation.
     */
    gates: {
        /** Gate overrides requested in the input payload */
        requestedOverrides?: {
            llmValidation?: boolean;
            gates?: unknown[];
            [key: string]: unknown;
        };
        /** IDs of temporary gates created for this execution */
        temporaryGateIds: string[];
        /** Scopes for temporary gates */
        temporaryGateScopes?: Array<{
            scope: string;
            scopeId: string;
        }>;
        /** Validation results from the gate system */
        validationResults?: unknown[];
        /** Call-to-action string returned by gate review */
        reviewCallToAction?: string;
        /** IDs of methodology-specific gates registered for this execution */
        methodologyGateIds?: string[];
        /** IDs of canonical gates that were resolved from temporary inputs */
        canonicalGateIdsFromTemporary?: string[];
        /** IDs of inline gates registered during extraction */
        registeredInlineGateIds?: string[];
        /** Whether the gate retry limit has been exceeded */
        retryLimitExceeded?: boolean;
        /** Gate IDs that have exhausted their retry attempts */
        retryExhaustedGateIds?: string[];
        /** Advisory warnings from non-blocking gate failures */
        advisoryWarnings?: string[];
        /** Resolved enforcement mode for the current gate set (most restrictive wins) */
        enforcementMode?: GateEnforcementMode;
        /** Whether user choice is being awaited after retry exhaustion */
        awaitingUserChoice?: boolean;
        /** Accumulated gate IDs from enhancement stage for downstream use */
        accumulatedGateIds?: string[];
        /** Whether blocking gates are present that require review */
        hasBlockingGates?: boolean;
    };
}
